pipeline {
	agent any
	stages {

		stage('Unit test') {
			steps {
				sh"""
				    mvn clean test
				"""
			}
		}

		stage('Build jar') {
            steps {
                sh"""
                    mvn package  -DskipTests=true
                """
            }
        }

        stage('Build Docker') {
            steps {
                sh"""
                    docker build -t ittiel/fyber-consul-service:1.0.0 .
                """
            }
        }

        stage('Deploy to registy') {
            steps {
                echo "Deploying artifact to Docker registry"
            }
        }
        stage('clean dir') {
        			steps {
        				deleteDir() /* clean up our workspace */
        			}
        		}
	}
}